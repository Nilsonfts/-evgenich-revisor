import logging
import os
import telebot
import datetime
import gspread
from oauth2client.service_account import ServiceAccountCredentials
from telebot import types

# ะะฐัััะพะนะบะฐ ะปะพะณะณะตัะฐ
logging.basicConfig(level=logging.INFO)

# ะะตัะตะผะตะฝะฝัะต ะพะบััะถะตะฝะธั (ะดะปั Railway ะธะปะธ ะปะพะบะฐะปัะฝะพ)
BOT_TOKEN = os.getenv("BOT_TOKEN")
SPREADSHEET_ID = os.getenv("SPREADSHEET_ID")

# ะะฒัะพัะธะทะฐัะธั Google Sheets
scope = ["https://spreadsheets.google.com/feeds", "https://www.googleapis.com/auth/drive"]
creds = ServiceAccountCredentials.from_json_keyfile_name("credentials.json", scope)
client = gspread.authorize(creds)
sheet = client.open_by_key(SPREADSHEET_ID).sheet1

bot = telebot.TeleBot(BOT_TOKEN)

soviet_phrases = {
    "check_in": [
        "๐ป ะะฐ ัะผะตะฝะต! ะะพัะพะฒ ะฒะตัะฐัั ะฒ ััะธั, ะบะฐะบ ะฟะพ ะะะกะขั!",
        "๐ฐ๏ธ ะัะธะฑัะป, ะบะฐะบ ััะฐะผะฒะฐะน ะฟะพ ัะฐัะฟะธัะฐะฝะธั.",
        "๐งฐ ะะฐัััะฟะฐั. ะัั ะฟะพะด ะบะพะฝััะพะปะตะผ, ะบะฐะบ ั ะดะธัะฟะตััะตัะฐ!",
        "๐โโ๏ธ ะ ัััะพั! ะะฐะฟะพัััั ะพ ะฟัะธะฑััะธะธ.",
        "๐๏ธ ะะพัะพะฒ ัะฐะฑะพัะฐัั ะฝะฐ ะฑะปะฐะณะพ ััะธัะฐ.",
        "๐ก ะัะธัะผ! ะะตะดััะธะน ะฝะฐ ัะฒัะทะธ.",
        "๐ ะะฐะฑะพัะฐั ัััะพะณะพ ะฟะพ ัะตะณะปะฐะผะตะฝัั.",
        "โ๏ธ ะะพัะพะฒ ะบ ัััะดั ะธ ะพะฑะพัะพะฝะต!",
        "๐๏ธ ะฃ ะผะธะบัะพัะพะฝะฐ, ะผะพะถะฝะพ ะฝะฐัะธะฝะฐัั ัะพั!",
        "๐ง ะะฝััััะผะตะฝั ะฟัะธ ะผะฝะต, ะณะพะปะพั ะฟัะธ ัะตะฑะต.",
        "๐ป ะะฐะดะธะพัะพัะบะฐ ะฐะบัะธะฒะธัะพะฒะฐะฝะฐ.",
        "๐ถ๏ธ ะัะฝะบััะฐะปะตะฝ, ะบะฐะบ ะฝะธะบะพะณะดะฐ.",
        "๐๏ธ ะะพัะพะฒ ะบ ะฑะพั ะทะฐ ัะธััะพัั ััะธัะฐ.",
        "๐ ะะบะปัััะฝ. ะะฐััะถะตะฝ. ะกะพััะตะดะพัะพัะตะฝ.",
        "๐๏ธ ะัะต ะบะฝะพะฟะบะธ ะฝะฐะถะฐัั โ ะฟะพะตัะฐะปะธ!",
        "๐๏ธ ะขะตัะฝะธะบะฐ ัะฐะฑะพัะฐะตั, ะฒะตะดััะธะน ัะพะถะต.",
        "๐ ะะฐ ะฟัะพะฒะพะดะต. ะะฒะพะฝะธัะต, ะฟะธัะธัะต!",
        "๐ ะะพะบะปะฐะดัะฒะฐั: ัะผะตะฝะฐ ะฝะฐัะฐะปะฐัั.",
        "๐ะะตััะพะฝะฐัะพะถะดะตะฝะธะต ะฟะพะดัะฒะตัะถะดะตะฝะพ.",
        "๐ ะะพััะป ะฒ ะทะพะฝั ะฒะตัะฐะฝะธั."
    ],
    "voice_reminder": [
        "๐ ะขะพะฒะฐัะธั, ะฟะพัะฐ ะฑั ัะถะต ะฟัะพะณะพะฒะพัะธัั ัะตะบัั!",
        "๐ข ะญัะธั ะถะดัั, ะผะธะบัะพัะพะฝ ัะบััะฐะตั!",
        "๐๏ธ ะะตะท ะณะพะปะพัะฐ โ ะบะฐะบ ะฑะตะท ัะปะตะฑะฐ!",
        "โฐ ะะฐะฟะพะผะฝั ะฝะตะถะฝะพ โ ัะตะบัั ะฒ ัััะดะธั!",
        "๐ป ะะพะปัะฐะฝะธะต โ ะฝะต ะทะพะปะพัะพ, ะฐ ัััะฐั!",
        "๐ ะัะตะผั ะทะฒััะฐัั, ะฐ ะฝะต ะผะพะปัะฐัั!",
        "๐ฌ ะญะน, ัั ัะฐะผ? ะญัะธั ะฟััััะตั!",
        "๐ก ะะตัะตะดะฐะน ัะปะพะฒะพ ะฒ ััะธั!",
        "๐ค ะะดะต ัะฒะพะน ะณะพะปะพั, ะฒะตะดััะธะน?!",
        "๐งญ ะะพัะฐ ะฝะฐะฟะพะผะฝะธัั ะพ ัะตะฑะต ััะธัะฝะพะน ะฒะพะปะฝะต.",
        "๐ฃ๏ธ ะะตัั โ ัะฒะพะน ัะฐะฑะพัะธะน ะธะฝััััะผะตะฝั!",
        "๐๏ธ ะะพะปะพั โ ััะพ ัะธะณะฝะฐะป. ะะพะดะฐะน ะตะณะพ!",
        "๐ ะกะบะฐะถะธ ัะพัั ััะพ-ะฝะธะฑัะดั!",
        "๐ฏ๏ธ ะะต ะผะพะปัะธ โ ััะธั ัะตะฑั ะถะดัั!",
        "๐ง ะกะปััะฐัะตะปะธ ัะพะผัััั!",
        "๐ ะะต ะทะฐะฑัะดั ะพัะฟัะฐะฒะธัั ะณะพะปะพั!",
        "๐ผ ะะต ะทะฒะตะฝะธั โ ะทะฝะฐัะธั, ัะบััะฝะพ!",
        "๐จ ะกัะพัะฝะพ ะฝัะถะตะฝ ัะตะบัั ะฒะตะดััะตะณะพ!",
        "๐ ะะพะปัะฐะฝะธะต โ ะฒัะฐะณ ะฟะปะฐะฝะฐ!",
        "๐ฏ ะญะน, ะฒะตะดััะธะน, ัะฐะทะฑัะดะธ ะฒะพะปะฝั!"
    ],
    "break_warn": [
        "โ ะะตัะตััะฒ ะฟะพะฝััะตะฝ, ะฝะพ ะฝะต ะฟัะตะฒัะฐัะฐะนัั ะฒ ัะฐะผะพะฒะฐั!",
        "๐ ะฃะถะต 15 ะผะธะฝัั โ ะฟะพัะฐ ะฒะพะทะฒัะฐัะฐัััั ะฒ ะฑะพะน!",
        "๐ฏ ะะดะต ัั ัะฐะผ? ะะฐัะพะด ะฒะพะปะฝัะตััั!",
        "๐ต๏ธโโ๏ธ ะะฐัะธะดะตะปัั! ะะธััะธะฟะปะธะฝะฐ ะฟัะตะถะดะต ะฒัะตะณะพ.",
        "๐จ ะะพะทะฒัะฐัะฐะนัั, ะฟะพะบะฐ ัะตะฑั ะฝะต ะทะฐะฑัะปะธ!",
        "โณ ะะตัะตััะฒ โ ััะพ 15 ะผะธะฝัั, ะฝะต 15 ะดะฝะตะน!",
        "๐๏ธ ะะพัะต ะพัััะป โ ะฒ ััะธั ะฟะพัะฐ!",
        "๐ ะะพะปะณะธะน ะพัะดัั = ัะฝะธะถะตะฝะธะต ะะะ.",
        "๐ฏ ะคะพะบัั ัะตััะตััั! ะะพะทะฒัะฐัะฐะนัั!",
        "๐ ะะปะฐะฝ ะฝะต ะถะดัั!",
        "๐ฅ ะะตัะตััะฒ โ ััะพ ะฝะต ะพัะฟััะบ!",
        "๐ฆะะบะปััะฐะนัั! ะะพัะฐ ะฟัะพะดะพะปะถะฐัั!",
        "๐ ะะพัะฐัะธั ะทะฐะบะพะฝัะตะฝะฐ. ะะพัะฐ ะฝะฐ ะฟะพัั!",
        "๐ถ ะกะฒัะทั ะฒะพัััะฐะฝะฐะฒะปะธะฒะฐะน โ ััะธั ะทะพะฒัั!",
        "๐ ะะตัะตััะฒ ะฑัะป. ะขะตะฟะตัั โ ัััะด!",
        "๐ ะะพะผะฐะฝะดะพะฒะฐะฝะธะต ะทะฐัะธะบัะธัะพะฒะฐะปะพ ะพััััััะฒะธะต!",
        "๐งญ ะะฐะนะดะตะฝ ะฒะฝะต ะทะพะฝั ะฟะพะบัััะธั โ ะฒะพะทะฒัะฐัะฐะนัั!",
        "๐ก ะกะธะณะฝะฐะป ัะปะฐะฑัะน. ะะพะทะฒัะฐั ะฒ ััะธั ะฝะตะพะฑัะพะดะธะผ!",
        "๐๏ธ ะะพะฝััะพะปั ะพัะปะฐะฑ! ะกัะพัะฝะพ ะฝะฐ ะผะตััะพ!",
        "โ๏ธ ะกะปะธัะบะพะผ ัะธัะพ. ะะพะดะพะทัะธัะตะปัะฝะพ..."
    ],
    "report": [
        "โ ะัะธะฝััะพ! ะะพะบะปะฐะด ะฑะปะตััััะธะน!",
        "๐ ะัััั ะฟัะธะฝัั, ะบะฐะบ ัะพัั ะฝะฐ ะฑะฐะฝะบะตัะต!",
        "๐๏ธ ะัั ะฒะฝะตัะตะฝะพ. ะะพะปะพะดะตั!",
        "๐ ะกะธััะตะผะฐ ะดะพะฒะพะปัะฝะฐ ัะฒะพะตะน ะดะธััะธะฟะปะธะฝะพะน.",
        "๐งพ ะะฐัะธะบัะธัะพะฒะฐะฝะพ ะฒ ะปะตัะพะฟะธััั ัะฐะฑะพัะตะณะพ ะดะฝั.",
        "๐ ะะฐะฝะฝัะต ะทะฐะฝะตัะตะฝั. ะัะพััะพัะท ะพะดะพะฑัะธั.",
        "๐ ะ ะพััััะต ะฒัั ัััะบะพ. ะฅะพัะพัะพ ะฟะพัะฐะฑะพัะฐะป!",
        "โ๏ธ ะัะผะฐะณะฐ ััะตัะฟะตะปะฐ โ ะธ ัะฐะฑะปะธัะฐ ัะพะถะต.",
        "๐ฎ ะะฐัะตะณะธัััะธัะพะฒะฐะฝะพ. ะะฐะฑะพัะฐ ะธะดัั!",
        "๐ ะะบะปะฐะด ะพัะผะตัะตะฝ. ะขั ะฝะฐะดัะถะตะฝ, ะบะฐะบ ัะพะบะฐัั!",
        "๐ ะัััั ะฒัะณะปัะดะธั ะดะพััะพะนะฝะพ.",
        "๐ ะัะธะฝััะพ ะธ ะฟัะพะฒะตัะตะฝะพ. ะัั ะฟะพ ัััะฐะฒั!",
        "๐ ะะพะณ ะพะฑะฝะพะฒะปัะฝ. ะขะพะฒะฐัะธัะธ ะดะพะฒะพะปัะฝั!",
        "๐ ะััะธะฒ ะฟะพะฟะพะปะฝะธะปัั ัะฒะตะถะตะน ัััะพะบะพะน.",
        "๐ ะัะผะฐะณะธ ะปะตัะฐัั, ะพัััั ะณะพัะพะฒ!",
        "๐ ะะตะปะพ ัะดะตะปะฐะฝะพ, ะทะฐะฟะธัั ัะพััะฐะฝะตะฝะฐ!",
        "๐จ ะัะธะฝััะพ. ะะฝัะพัะผะฐัะธั ััะปะฐ ะฒ ััะพะฝะธะบั!",
        "๐ผ ะัั ะฟะพ ัะตะณะปะฐะผะตะฝัั. ะกะฟะฐัะธะฑะพ!",
        "๐๏ธ ะกะบัะตะฟะปะตะฝะพ ะธ ะทะฐะฐััะธะฒะธัะพะฒะฐะฝะพ!",
        "๐ ะะถะตะดะฝะตะฒะฝัะน ะฟะพะดะฒะธะณ ะทะฐัะธะบัะธัะพะฒะฐะฝ."
    ]
}

@bot.message_handler(commands=["start", "help"])
def send_welcome(message):
    bot.reply_to(message, "ะกะฐะปะฐะผ, ะฒะตะดััะธะน! ะัะฟะพะปัะทัะน /ะพััะตั ััะพะฑั ะฒะฝะตััะธ ัะฒะพะน ะฒะบะปะฐะด ะฒ ัะปะฐะฒะฝัั ัะฐะฑะปะธัั.")

@bot.message_handler(commands=["ะพััะตั"])
def handle_report(message):
    user = message.from_user
    username = f"@{user.username}" if user.username else user.first_name
    now = datetime.datetime.now().strftime("%d.%m.%Y")
    phrase = soviet_phrases["report"][hash(user.id) % len(soviet_phrases["report"])]

    # ะะฐะณะปััะบะฐ ัะธัะตะป โ ะฟะพ-ัะพัะพัะตะผั, ะดะพะปะถะฝั ัะฟัะฐัะธะฒะฐัััั
    facts = "3"
    could_be = "5"

    row = [f"#{now}", username, facts, could_be, phrase]
    sheet.append_row(row)
    logging.info(f"ะะพะฑะฐะฒะปะตะฝ ะพััะตั: {row}")
    bot.reply_to(message, f"{phrase}\nะะฐะฟะธัะฐะฝะพ ะฒ ะถััะฝะฐะป ะทะฐ {now}")

bot.polling()
